--[[ ============================================================
 MegaHack GUI – Big, Clean, Scrollable Tabs (X) & Content (Y)
 - Horizontal tab bar (scroll left/right)
 - Vertical content list (scroll up/down)
 - Toggle button bottom-left (icon 118732820826841)
 - Includes "Doors" tab with "Black King|KeyLess"
 - Safe, tidy, mobile-friendly
===============================================================]]

-- Services
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")

local player = Players.LocalPlayer

-- Root ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "MegaHackUI_V2"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

-- Optional blur for focus
local blur = Instance.new("BlurEffect")
blur.Size = 0
blur.Parent = Lighting

-- ================= LOADING =================
local loadingFrame = Instance.new("Frame")
loadingFrame.Size = UDim2.new(1,0,1,0)
loadingFrame.BackgroundColor3 = Color3.fromRGB(12,12,16)
loadingFrame.Parent = screenGui

local logo = Instance.new("ImageLabel")
logo.AnchorPoint = Vector2.new(0.5,0.5)
logo.Position = UDim2.new(0.5,0,0.38,0)
logo.Size = UDim2.new(0,130,0,130)
logo.BackgroundTransparency = 1
logo.Image = "rbxassetid://118732820826841"
logo.Parent = loadingFrame

local loadingText = Instance.new("TextLabel")
loadingText.AnchorPoint = Vector2.new(0.5,0.5)
loadingText.Position = UDim2.new(0.5,0,0.55,0)
loadingText.BackgroundTransparency = 1
loadingText.Size = UDim2.new(0,520,0,42)
loadingText.Font = Enum.Font.GothamBold
loadingText.TextSize = 28
loadingText.Text = "MegaHack — Loading..."
loadingText.Parent = loadingFrame

local hue = 0
RunService.RenderStepped:Connect(function(dt)
    logo.Rotation = (logo.Rotation + 90*dt) % 360
    hue = (hue + 0.006) % 1
    loadingText.TextColor3 = Color3.fromHSV(hue,1,1)
end)

local barBG = Instance.new("Frame")
barBG.AnchorPoint = Vector2.new(0.5,0.5)
barBG.Position = UDim2.new(0.5,0,0.67,0)
barBG.Size = UDim2.new(0,380,0,18)
barBG.BackgroundColor3 = Color3.fromRGB(32,34,46)
barBG.Parent = loadingFrame
Instance.new("UICorner", barBG).CornerRadius = UDim.new(0,9)

local barFill = Instance.new("Frame")
barFill.Size = UDim2.new(0,0,1,0)
barFill.BackgroundColor3 = Color3.fromRGB(0,180,255)
barFill.Parent = barBG
Instance.new("UICorner", barFill).CornerRadius = UDim.new(0,9)

-- ================= MAIN GUI =================
local mainFrame = Instance.new("Frame")
mainFrame.AnchorPoint = Vector2.new(0.5,0.5)
mainFrame.Position = UDim2.new(0.5,0,0.5,0)
mainFrame.Size = UDim2.new(0,720,0,520) -- to hơn
mainFrame.BackgroundColor3 = Color3.fromRGB(24,26,34)
mainFrame.Visible = false
mainFrame.Parent = screenGui
Instance.new("UICorner", mainFrame).CornerRadius = UDim.new(0,18)
mainFrame.Active = true
mainFrame.Draggable = true

-- Header (tabs bar container) — ScrollingFrame for horizontal scroll
local tabBar = Instance.new("ScrollingFrame")
tabBar.Name = "TabBar"
tabBar.AnchorPoint = Vector2.new(0.5,0)
tabBar.Position = UDim2.new(0.5,0,0,10)
tabBar.Size = UDim2.new(1,-20,0,46)
tabBar.BackgroundColor3 = Color3.fromRGB(36,38,52)
tabBar.ScrollBarThickness = 4
tabBar.ScrollingDirection = Enum.ScrollingDirection.X
tabBar.CanvasSize = UDim2.new(0,0,0,0)
tabBar.BorderSizePixel = 0
tabBar.Parent = mainFrame
Instance.new("UICorner", tabBar).CornerRadius = UDim.new(0,12)

local tabList = Instance.new("UIListLayout")
tabList.FillDirection = Enum.FillDirection.Horizontal
tabList.Padding = UDim.new(0,8)
tabList.HorizontalAlignment = Enum.HorizontalAlignment.Left
tabList.Parent = tabBar

-- auto-expand CanvasSize for horizontal dragging
tabList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    tabBar.CanvasSize = UDim2.new(0, tabList.AbsoluteContentSize.X + 12, 0, 0)
end)

-- Content area – ScrollingFrame for vertical scroll
local contentFrame = Instance.new("ScrollingFrame")
contentFrame.Name = "Content"
contentFrame.AnchorPoint = Vector2.new(0.5,1)
contentFrame.Position = UDim2.new(0.5,0,1,-12)
contentFrame.Size = UDim2.new(1,-20,1,-72) -- chừa chỗ cho tabBar
contentFrame.BackgroundTransparency = 1
contentFrame.ScrollBarThickness = 8
contentFrame.ScrollingDirection = Enum.ScrollingDirection.Y
contentFrame.CanvasSize = UDim2.new(0,0,0,0)
contentFrame.Parent = mainFrame

local btnList = Instance.new("UIListLayout")
btnList.Padding = UDim.new(0,10)
btnList.HorizontalAlignment = Enum.HorizontalAlignment.Center
btnList.Parent = contentFrame

btnList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    contentFrame.CanvasSize = UDim2.new(0,0,0, btnList.AbsoluteContentSize.Y + 10)
end)

-- Helper: create a pretty button
local function createScriptButton(parent, text)
    local b = Instance.new("TextButton")
    b.Size = UDim2.new(0, 520, 0, 44)
    b.BackgroundColor3 = Color3.fromRGB(64,66,92)
    b.AutoButtonColor = true
    b.Text = text
    b.TextColor3 = Color3.new(1,1,1)
    b.Font = Enum.Font.GothamBold
    b.TextSize = 20
    b.Parent = parent
    Instance.new("UICorner", b).CornerRadius = UDim.new(0,10)
    -- subtle hover grow
    b.MouseEnter:Connect(function()
        TweenService:Create(b, TweenInfo.new(0.12), {Size = UDim2.new(0,540,0,46)}):Play()
    end)
    b.MouseLeave:Connect(function()
        TweenService:Create(b, TweenInfo.new(0.12), {Size = UDim2.new(0,520,0,44)}):Play()
    end)
    return b
end

-- Safe loader
local function safeLoad(url)
    local ok, res = pcall(function()
        return game:HttpGet(url)
    end)
    if not ok then
        warn("HttpGet failed for:", url, res)
        return
    end
    local ok2, err = pcall(function()
        loadstring(res)()
    end)
    if not ok2 then
        warn("loadstring failed:", err)
    end
end

-- Build a tab (button on tab bar + onClick fills content)
local function createTab(name, iconId, scripts, setDefault)
    local tab = Instance.new("TextButton")
    tab.Size = UDim2.new(0, 160, 1, 0)
    tab.BackgroundColor3 = Color3.fromRGB(56,58,82)
    tab.AutoButtonColor = true
    tab.Text = ""
    tab.Parent = tabBar
    Instance.new("UICorner", tab).CornerRadius = UDim.new(0,10)

    local icon = Instance.new("ImageLabel")
    icon.Size = UDim2.new(0,22,0,22)
    icon.Position = UDim2.new(0,10,0.5,-11)
    icon.BackgroundTransparency = 1
    icon.Image = iconId or ""
    icon.Parent = tab

    local lbl = Instance.new("TextLabel")
    lbl.BackgroundTransparency = 1
    lbl.Position = UDim2.new(0, 40, 0, 0)
    lbl.Size = UDim2.new(1, -46, 1, 0)
    lbl.Text = name
    lbl.TextXAlignment = Enum.TextXAlignment.Left
    lbl.Font = Enum.Font.GothamBold
    lbl.TextSize = 18
    lbl.TextColor3 = Color3.new(1,1,1)
    lbl.Parent = tab

    local function render()
        -- only delete previous buttons, keep layout
        for _, ch in ipairs(contentFrame:GetChildren()) do
            if ch:IsA("TextButton") then ch:Destroy() end
        end
        for _, data in ipairs(scripts) do
            local btn = createScriptButton(contentFrame, data.name)
            btn.MouseButton1Click:Connect(function()
                safeLoad(data.url)
            end)
        end
        -- ensure CanvasSize updated after new buttons
        RunService.Heartbeat:Wait()
        contentFrame.CanvasSize = UDim2.new(0,0,0, btnList.AbsoluteContentSize.Y + 10)
    end

    tab.MouseButton1Click:Connect(render)
    if setDefault then render() end
end

-- ================= TABS & SCRIPTS =================
-- Doors tab (the one you asked)
createTab("Doors", "rbxassetid://118732820826841", {
    { name = "Black King|KeyLess", url = "https://raw.githubusercontent.com/KINGHUB01/BlackKing-obf/main/Doors%20Blackking%20And%20BobHub" }
}, true)

-- You can add more tabs (examples kept)
createTab("Visual", "rbxassetid://118732820826841", {
    { name = "PShader", url = "https://raw.githubusercontent.com/randomstring0/pshade-ultimate/refs/heads/main/src/cd.lua" },
    { name = "Show FPS", url = "https://raw.githubusercontent.com/Truongthanhden23023/fps/refs/heads/main/fps" },
})
createTab("Fun", "rbxassetid://118732820826841", {
    { name = "Emote (Fast)", url = "https://rawscripts.net/raw/Universal-Script-Emote-Script-but-Fast-47944" },
    { name = "Gazer Editor", url = "https://rawscripts.net/raw/Universal-Script-Gazer-FE-Animation-Editor-14508" },
})

createTab("Utility", "rbxassetid://118732820826841", {
    { name = "Infinite Yield", url = "https://rawscripts.net/raw/Universal-Script-Infinite-Yield-31802" },
    { name = "Fake Lag Runner", url = "https://rawscripts.net/raw/Universal-Script-Fake-Lag-Runner-read-description-44701" },
})

-- ================= TOGGLE (bottom-left) =================
local toggleBtn = Instance.new("ImageButton")
toggleBtn.Name = "ToggleUI"
toggleBtn.AnchorPoint = Vector2.new(0,1)
toggleBtn.Position = UDim2.new(0, 12, 1, -12)
toggleBtn.Size = UDim2.new(0, 58, 0, 58)
toggleBtn.BackgroundColor3 = Color3.fromRGB(28,30,40)
toggleBtn.Image = "rbxassetid://118732820826841"
toggleBtn.Parent = screenGui
Instance.new("UICorner", toggleBtn).CornerRadius = UDim.new(0,12)

local uiVisible = false
local function setUIVisible(v)
    uiVisible = v
    mainFrame.Visible = v
    TweenService:Create(blur, TweenInfo.new(0.25), {Size = v and 16 or 0}):Play()
end
toggleBtn.MouseButton1Click:Connect(function()
    setUIVisible(not uiVisible)
end)

-- open/close with key P (desktop)
UserInputService.InputBegan:Connect(function(input, gpe)
    if gpe then return end
    if input.KeyCode == Enum.KeyCode.P then
        setUIVisible(not uiVisible)
    end
end)

-- ================= FINISH LOADING =================
TweenService:Create(barFill, TweenInfo.new(1.8, Enum.EasingStyle.Linear), {Size = UDim2.new(1,0,1,0)}):Play()
task.wait(1.9)
TweenService:Create(loadingFrame, TweenInfo.new(0.4), {BackgroundTransparency = 1}):Play()
TweenService:Create(logo, TweenInfo.new(0.25), {ImageTransparency = 1}):Play()
TweenService:Create(loadingText, TweenInfo.new(0.25), {TextTransparency = 1}):Play()
TweenService:Create(barBG, TweenInfo.new(0.25), {BackgroundTransparency = 1}):Play()
TweenService:Create(barFill, TweenInfo.new(0.25), {BackgroundTransparency = 1}):Play()
task.wait(0.45)
loadingFrame:Destroy()
setUIVisible(true)
